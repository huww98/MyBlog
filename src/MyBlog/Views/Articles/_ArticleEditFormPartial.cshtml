@model Article

@{string actionName = Model == null ? "Create" : "Edit";}
<div class="modal fade" id="imageModal" tabindex="-1" role="dialog" aria-labelledby="imageModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="imageModalLabel">插入图片</h4>
            </div>
            <div class="modal-body">
                <input id="imageFile" name="imageFile" type="file" multiple class="file-loading">
            </div>
        </div>
    </div>
</div>
<form asp-action=@actionName id="article-form" autocomplete="off">
    <div class="form-horizontal">
        <h4>文章</h4>
        <hr />
        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
        @if (Model != null)
        {
            <input type="hidden" asp-for="ID" />
        }
        <div class="form-group">
            <label asp-for="Title" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <input asp-for="Title" class="form-control" />
                <span asp-validation-for="Title" class="text-danger"></span>
            </div>
        </div><div class="form-group">
            <label asp-for="Categories" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                @(await Component.InvokeAsync<CategorySelectorViewComponent>(new
            {
                Name = "CategoryIDs",
                PreselectedIDs = ViewBag.CategoryIDs,
                IsMultiple = true
            }))
            </div>
        </div>
        <div class="form-group">
            <label asp-for="Content" class="col-md-2 control-label"></label>
            <div class="col-md-10">
                <div id="wysiwyg-group">
                    <div class="btn-toolbar" data-role="editor-toolbar" id="editor-toolbar"
                         data-target="#editor">
                        <div class="btn-group">
                            <a class="btn btn-default" title="切换到HTML源码" onclick="showHtml()"><i class='glyphicon glyphicon-pencil'></i></a>
                        </div>
                        <div class="btn-group">
                            <a class="btn btn-default dropdown-toggle" data-toggle="dropdown" title="Font Size"><i class="fa fa-text-height"></i>&nbsp;<b class="caret"></b></a>
                            <ul class="dropdown-menu">
                                <li><a data-edit="fontSize 7" style="font-size:xx-large">特大</a></li>
                                <li><a data-edit="fontSize 6" style="font-size:x-large">加大</a></li>
                                <li><a data-edit="fontSize 5" style="font-size:large">大</a></li>
                                <li><a data-edit="fontSize 3" style="font-size:medium">中</a></li>
                                <li><a data-edit="fontSize 1" style="font-size:x-small">小</a></li>
                            </ul>
                        </div>
                        <div class="btn-group">
                            <a class="btn btn-default" data-edit="bold" title="Bold (Ctrl/Cmd+B)"><i class="fa fa-bold"></i></a>
                            <a class="btn btn-default" data-edit="italic" title="Italic (Ctrl/Cmd+I)"><i class="fa fa-italic"></i></a>
                            <a class="btn btn-default" data-edit="strikethrough" title="Strikethrough"><i class="fa fa-strikethrough"></i></a>
                            <a class="btn btn-default" data-edit="underline" title="Underline (Ctrl/Cmd+U)"><i class="fa fa-underline"></i></a>
                        </div>
                        <div class="btn-group">
                            <a class="btn btn-default" data-edit="insertunorderedlist" title="Bullet list"><i class="fa fa-list-ul"></i></a>
                            <a class="btn btn-default" data-edit="insertorderedlist" title="Number list"><i class="fa fa-list-ol"></i></a>
                            <a class="btn btn-default" data-edit="outdent" title="Reduce indent (Shift+Tab)"><i class="fa fa-outdent"></i></a>
                            <a class="btn btn-default" data-edit="indent" title="Indent (Tab)"><i class="fa fa-indent"></i></a>
                        </div>
                        <div class="btn-group">
                            <a class="btn btn-default" data-edit="justifyleft" title="左对齐 (Ctrl/Cmd+L)"><i class="fa fa-align-left"></i></a>
                            <a class="btn btn-default" data-edit="justifycenter" title="居中对齐 (Ctrl/Cmd+E)"><i class="fa fa-align-center"></i></a>
                            <a class="btn btn-default" data-edit="justifyright" title="右对齐 (Ctrl/Cmd+R)"><i class="fa fa-align-right"></i></a>
                            <a class="btn btn-default" data-edit="justifyfull" title="分散对齐 (Ctrl/Cmd+J)"><i class="fa fa-align-justify"></i></a>
                        </div>
                        <div class="btn-group">
                            <div class="btn-group">
                                <a class="btn btn-default dropdown-toggle" data-toggle="dropdown" title="Hyperlink"><i class="fa fa-link"></i></a>
                                <div class="dropdown-menu input-append">
                                    <input class="form-control" placeholder="URL" type="text" data-edit="createLink" />
                                    <button class="btn btn-default" type="button">Add</button>
                                </div>
                            </div>
                            <a class="btn btn-default" data-edit="unlink" title="Remove Hyperlink"><i class="fa fa-unlink"></i></a>
                        </div>
                        <div class="btn-group">
                            <a class="btn btn-default" data-edit="undo" title="Undo (Ctrl/Cmd+Z)"><i class="fa fa-undo"></i></a>
                            <a class="btn btn-default" data-edit="redo" title="Redo (Ctrl/Cmd+Y)"><i class="fa fa-repeat"></i></a>
                            <a class="btn btn-default" data-edit="clearformat" title="Clear Formatting" onClick="$('#editor').html($('#editor').text());"><i class='glyphicon glyphicon-fire'></i></a>
                        </div>
                        <div class="btn-group">
                            <a class="btn btn-default" data-toggle="modal" data-target="#imageModal" title="插入图片"><i class="fa fa-picture-o"></i></a>
                        </div>
                    </div>
                    <div class="form-control" id="editor" contenteditable="true">
                        @if (Model != null)
                        {
                            @Html.Raw(Model.Content)
                        }
                    </div>
                </div>

                <div id="html-group" style="display:none">
                    <a class="btn btn-default" title="切换到所见即所得" id="content-btn" onclick="showWysiwyg()"><i class='glyphicon glyphicon-pencil'></i></a>
                    <textarea asp-for="Content" class="form-control" rows="14"></textarea>
                </div>
                <span class="text-danger" asp-validation-for="Content"></span>
            </div>
        </div>
        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <a class="btn btn-default" onclick="prepareToSubmit(); $('#article-form').submit();">
                    @(Model == null ? "新建" : "保存")
                </a>
            </div>
        </div>
    </div>
</form>